<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garagem Inteligente V3 - Funcionalidades Extras</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- ÁREA DE NOTIFICAÇÃO GLOBAL -->
    <div id="notification-area">
        <span id="notification-message"></span>
        <button class="close-btn" title="Fechar notificação" aria-label="Fechar notificação">×</button>
    </div>

    <!-- TELA DE AUTENTICAÇÃO -->
    <div id="auth-container" class="card" style="max-width: 450px; margin: 50px auto; text-align: center;">
        <h2><i class="fas fa-warehouse"></i> Bem-vindo à Garagem V3</h2>
        <p style="margin-bottom: 25px;">Faça login ou registre-se para gerenciar seus veículos.</p>
        <form id="formLogin" novalidate>
            <h3><i class="fas fa-sign-in-alt"></i> Entrar na sua Garagem</h3>
            <div style="text-align: left;"><label for="loginEmail"><i class="fas fa-envelope"></i> E-mail:</label><input type="email" id="loginEmail" placeholder="seu@email.com" required></div>
            <div style="text-align: left;"><label for="loginPassword"><i class="fas fa-key"></i> Senha:</label><input type="password" id="loginPassword" placeholder="Sua senha" required></div>
            <button type="submit" style="width: 100%;"><i class="fas fa-door-open"></i> Entrar</button>
        </form>
        <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">
        <form id="formRegister" novalidate>
            <h3><i class="fas fa-user-plus"></i> Não tem uma conta? Registre-se!</h3>
            <div style="text-align: left;"><label for="registerEmail"><i class="fas fa-envelope"></i> E-mail:</label><input type="email" id="registerEmail" placeholder="Crie um e-mail para login" required></div>
            <div style="text-align: left;"><label for="registerPassword"><i class="fas fa-key"></i> Senha:</label><input type="password" id="registerPassword" placeholder="Mínimo 6 caracteres" required minlength="6"></div>
            <button type="submit" class="botao-info" style="width: 100%;"><i class="fas fa-plus-circle"></i> Criar Conta</button>
        </form>
    </div>

    <!-- CONTAINER PRINCIPAL DA APLICAÇÃO -->
    <div id="app-container" style="display: none;">

        <aside id="sidebar">
            <div class="sidebar-header"><i class="fas fa-warehouse"></i><h1>Garagem V3</h1></div>
            <button id="btnAbrirModalAdicionar" class="botao-sidebar-add"><i class="fas fa-plus-circle"></i> Adicionar Novo Veículo</button>
            <div class="lista-veiculos-container card">
                <h2><i class="fas fa-car"></i> Meus Veículos</h2>
                <ul id="listaVeiculosSidebar"><li class="placeholder">Nenhum veículo na garagem.</li></ul>
            </div>
            <button id="btnLogout" class="botao-perigo" style="width: 100%; margin-top: auto;"><i class="fas fa-sign-out-alt"></i> Sair</button>
        </aside>

        <main id="main-content">
            <div id="painelVeiculoSelecionado" style="display: none;" class="card">
                <div class="vehicle-header">
                    <img id="imagemVeiculo" src="https://i.imgur.com/2s46e5k.png" alt="Ícone de carro">
                    <div id="informacoesVeiculo">
                        <h2 id="info-modelo-placa">Modelo (Placa)</h2>
                        <!-- Local para exibir o TIPO -->
                        <p><i class="fas fa-car-burst"></i><strong id="info-tipo">Tipo</strong></p>
                        <p><i class="fas fa-car-side"></i><strong id="info-marca">Marca</strong></p>
                        <p><i class="fas fa-palette"></i><strong id="info-cor">Cor</strong></p>
                        <p><i class="fas fa-calendar-alt"></i><strong id="info-ano">Ano</strong></p>
                        <p><i class="fas fa-hashtag"></i><span class="info-id-text" id="info-id">ID</span></p>
                    </div>
                    <div class="vehicle-header-actions">
                        <button id="botaoEditarHeader" class="botao-info"><i class="fas fa-pencil-alt"></i> Editar Veículo</button>
                        <button id="botaoRemoverHeader" class="botao-perigo"><i class="fas fa-trash-alt"></i> Remover</button>
                    </div>
                </div>

                <div id="painelDeControle">
                    <div class="status-motor-container"><i class="fas fa-power-off"></i> Status do Motor: <span id="info-status-motor">Desligado</span></div>
                    <div class="velocimetro-container">
                        <svg class="velocimetro-svg" viewBox="0 0 100 100">
                            <circle class="velocimetro-trilha" cx="50" cy="50" r="40"></circle>
                            <circle id="velocimetro-progresso" class="velocimetro-progresso" cx="50" cy="50" r="40"></circle>
                        </svg>
                        <div id="velocimetro-texto" class="velocimetro-texto">0 km/h</div>
                    </div>
                    <div id="botoesAcoes" class="botoes-container">
                        <button id="botaoLigarDesligar" data-action="ligar"><i class="fas fa-power-off"></i> Ligar</button>
                        <button id="botaoAcelerar" data-action="acelerar" disabled><i class="fas fa-gas-pump"></i> Acelerar</button>
                        <button id="botaoFrear" data-action="frear" disabled><i class="fas fa-brake"></i> Frear</button>
                    </div>
                </div>

                <nav class="tabs-veiculo">
                    <button class="tab-link active" data-tab="tab-manutencao"><i class="fas fa-tools"></i> Manutenção</button>
                    <button class="tab-link" data-tab="tab-detalhes"><i class="fas fa-info-circle"></i> Detalhes Extras</button>
                </nav>

                <div id="tab-manutencao" class="tab-content active">
                    <div class="manutencao-container">
                        <div id="formManutencaoContainer" class="card-inner">
                            <h3><i class="fas fa-plus-circle"></i> Nova Manutenção</h3>
                            <form id="formNovaManutencao"><input type="hidden" id="manutencaoVeiculoId" name="veiculo"><div><label for="manutencaoDescricao">Descrição do Serviço:</label><input type="text" id="manutencaoDescricao" name="descricaoServico" required placeholder="Ex: Troca de óleo"></div><div><label for="manutencaoData">Data:</label><input type="datetime-local" id="manutencaoData" name="data" required></div><div><label for="manutencaoCusto">Custo (R$):</label><input type="number" id="manutencaoCusto" name="custo" required placeholder="150.00" step="0.01" min="0"></div><button type="submit" class="botao-info">Adicionar Registro</button></form>
                        </div>
                        <div class="maintenance-list card-inner">
                            <h3><i class="fas fa-history"></i> Histórico</h3>
                            <ul id="listaManutencoesVeiculo"><li class="placeholder">Nenhum registro de manutenção.</li></ul>
                        </div>
                    </div>
                </div>
                <div id="tab-detalhes" class="tab-content">
                    <div class="detalhes-extras-container"><button id="btnVerDetalhesExtras" class="botao-info"><i class="fas fa-search"></i> Consultar Dados de Fábrica</button><div id="detalhesExtrasVeiculo" style="display: none;"></div></div>
                </div>
            </div>

            <!-- Seção de Previsão do Tempo -->
            <div id="secao-previsao-tempo" class="card" style="display: none;">
                <h2><i class="fas fa-cloud-sun-rain"></i> Previsão do Tempo para sua Viagem</h2>
                <div class="busca-container-tempo">
                    <input type="text" id="cidade-input-tempo" placeholder="Digite o nome de uma cidade...">
                    <button id="verificar-clima-btn" class="botao-info"><i class="fas fa-search-location"></i> Verificar</button>
                </div>
                <div id="previsao-status-mensagem" class="status-mensagem"></div>
                <div id="previsao-tempo-resultado"></div>
            </div>

            <div id="mensagem-selecione" style="display: block;" class="card">
                <h2><i class="fas fa-info-circle"></i> Bem-vindo à sua Garagem!</h2>
                <p>Adicione um veículo para começar ou gerencie os veículos existentes na lista à esquerda.</p>
                <p>Clique em um veículo na lista para ver seus detalhes e controles.</p>
            </div>
        </main>
    </div>

    <!-- Modais -->
    <dialog id="modalAdicionarVeiculo">
        <form id="formNovoVeiculo" novalidate>
            <h2><i class="fas fa-plus-circle"></i> Adicionar Novo Veículo</h2>
            <!-- Campo de Seleção de TIPO -->
            <div>
                <label for="addTipo"><i class="fas fa-car-burst"></i> Tipo de Veículo:</label>
                <select id="addTipo" name="tipo" required>
                    <option value="">-- Escolha um tipo --</option>
                    <option value="Carro">Carro Normal</option>
                    <option value="Carro Esportivo">Carro Esportivo</option>
                    <option value="Caminhão">Caminhão</option>
                </select>
            </div>
            <div><label for="addPlaca"><i class="fas fa-digital-tachograph"></i> Placa:</label><input type="text" id="addPlaca" name="placa" required placeholder="ABC1234 ou ABC1D23" maxlength="7"></div>
            <div><label for="addMarca"><i class="fas fa-car-side"></i> Marca:</label><input type="text" id="addMarca" name="marca" required placeholder="Ex: Toyota"></div>
            <div><label for="addModelo"><i class="fas fa-car"></i> Modelo:</label><input type="text" id="addModelo" name="modelo" required placeholder="Ex: Corolla"></div>
            <div><label for="addAno"><i class="fas fa-calendar-alt"></i> Ano:</label><input type="number" id="addAno" name="ano" required placeholder="Ex: 2023" min="1900" max="2025"></div>
            <div><label for="addCor"><i class="fas fa-palette"></i> Cor:</label><input type="text" id="addCor" name="cor" required placeholder="Ex: Prata"></div>
            <div class="modal-actions"><button type="button" id="btnFecharModalAdicionar" class="botao-cancelar">Cancelar</button><button type="submit" class="botao-sucesso">Adicionar</button></div>
        </form>
    </dialog>

    <dialog id="modalEditarVeiculo">
        <form id="formEditarVeiculo" novalidate>
            <h2><i class="fas fa-pencil-alt"></i> Editar Veículo</h2>
            <input type="hidden" id="editVeiculoId" name="id">
            <!-- Campo de Seleção de TIPO (para editar) -->
            <div>
                <label for="editVeiculoTipo"><i class="fas fa-car-burst"></i> Tipo de Veículo:</label>
                <select id="editVeiculoTipo" name="tipo" required>
                    <option value="Carro">Carro Normal</option>
                    <option value="Carro Esportivo">Carro Esportivo</option>
                    <option value="Caminhão">Caminhão</option>
                </select>
            </div>
            <div><label for="editVeiculoPlaca"><i class="fas fa-digital-tachograph"></i> Placa:</label><input type="text" id="editVeiculoPlaca" name="placa" required maxlength="7"></div>
            <div><label for="editVeiculoMarca"><i class="fas fa-car-side"></i> Marca:</label><input type="text" id="editVeiculoMarca" name="marca" required></div>
            <div><label for="editVeiculoModelo"><i class="fas fa-car"></i> Modelo:</label><input type="text" id="editVeiculoModelo" name="modelo" required></div>
            <div><label for="editVeiculoAno"><i class="fas fa-calendar-alt"></i> Ano:</label><input type="number" id="editVeiculoAno" name="ano" required min="1900" max="2025"></div>
            <div><label for="editVeiculoCor"><i class="fas fa-palette"></i> Cor:</label><input type="text" id="editVeiculoCor" name="cor" required></div>
            <div class="modal-actions"><button type="button" id="btnFecharModalEditar" class="botao-cancelar">Cancelar</button><button type="submit">Salvar Alterações</button></div>
        </form>
    </dialog>

    <script type="module" src="js/principal.js"></script>
</body>
</html>